<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="./styles/style.css" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous" />
    <title>GPU Blog</title>
  </head>

  <body>
    <%-include("./partials/header.ejs")%>
    <div id="main-add-post">
      <form>
        <div class="add-post">
          <div class="dropdown">
            <button
              class="btn btn-secondary dropdown-toggle"
              type="button"
              id="dropdownMenuButton"
              data-bs-toggle="dropdown"
              aria-haspopup="true"
              aria-expanded="false">
              Category
            </button>
            <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
              <a class="dropdown-item" onclick="selectCategory('Gen AI')"
                >Gen AI</a
              >
              <a class="dropdown-item" onclick="selectCategory('Gaming')"
                >Gaming</a
              >
              <a class="dropdown-item" onclick="selectCategory('Productivity')"
                >Productivity</a
              >
            </div>
          </div>

          <div>
            <label class="post-labels">Title:</label>
            <input
              type="text"
              class="post-text"
              style="width: 300px"
              id="post-title" />
          </div>
          <div>
            <label class="post-labels">Post:</label
            ><textarea
              class="post-text"
              id="post-content"
              minlength="10"
              maxlength="50"></textarea>
          </div>
          <div style="display: flex; gap: 20px">
            <button
              type="submit"
              class="submit-reset-button"
              onclick="
              event.preventDefault();
              const category =document.getElementById('dropdownMenuButton').textContent;
              const postTitle = document.getElementById('post-title').value;
              const postContent = document.getElementById('post-content').value;
              if(!postTitle||!postContent ||category == '\n              Category\n            '){ alert('Please enter shit.'); return;}
              fetch('/submit', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({category,postTitle, postContent})
              });
              ">
              Confirm Post
            </button>
            <button
              type="reset"
              class="submit-reset-button"
              style="width: 100px">
              Reset
            </button>
            <button
              type="button"
              class="submit-reset-button"
              id="close-button"
              onclick="goBack()">
              Close
            </button>
          </div>
        </div>
      </form>
    </div>
    <%-include("./partials/footer.ejs")%>
    <script>
      function selectCategory(category) {
        // Update the dropdown button text with the selected category
        document.getElementById("dropdownMenuButton").textContent = category;
      }
      function goBack() {
        if (window.history.length > 1) {
          window.history.back();
        } else {
          window.location.href = "/fallback-url"; // Redirect to a fallback URL if no history
        }
      }
    </script>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous"></script>
  </body>
</html>
